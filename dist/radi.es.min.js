var GLOBALS={VERSION:'0.5.0',CUSTOM_ATTRIBUTES:{},CUSTOM_TAGS:{},SERVICES:{}};function capitalise(n){return n.charAt(0).toUpperCase()+n.substr(1)}function ensureArray(n){if(arguments.length===0){return[]}if(arguments.length===1){if(n===void 0||n===null){return[]}if(Array.isArray(n)){return n}}return Array.prototype.slice.call(arguments)}function flatten(n){return n.reduce(function(n,t){return n.concat(Array.isArray(t)?flatten(t):t)},[])}var Component=function(n,t){this.self=n;this.name=t||n.name;this.__$events={}};Component.prototype.onMount=function(){};Component.prototype.on=function(n,t){var e=this.__$events,r="on"+(capitalise(n));e[r]||(e[r]=[]);e[r].push(t);return t};Component.prototype.trigger=function(n){var t,e,r=[],o=arguments.length-1;while(o-->0)r[o]=arguments[o+1];var i="on"+(capitalise(n));(this.__$events[i]||[]).map(function(n){return n.apply(void 0,r)});typeof this[i]==='function'&&(t=this)[i].apply(t,r);typeof this.self[i]==='function'&&(e=this.self)[i].apply(e,r)};function service(n,t){var e=[],r=arguments.length-2;while(r-->0)e[r]=arguments[r+2];if(typeof n!=='string'){throw new Error('[Radi.js] Service first argument has to be string')}if(typeof t!=='function'){throw new Error('[Radi.js] Service second argument has to be function')}var o='$'.concat(n),i=new Component(t,n),u=t.call.apply(t,[i].concat(e));i.trigger('mount');Component.prototype[o]=u;return GLOBALS.SERVICES[o]=u}function destroyTree$$1(n){fireEvent('destroy',n);if(n.nodeType===1){var t=n.firstChild;while(t)destroyTree$$1(t),t=t.nextSibling}}function fireEvent(n,t){var e=document.createEvent('Event');e.initEvent(n,!0,!0);typeof t.dispatchEvent==='function'&&(t._eventFired=!0,t.dispatchEvent(e));return t}function insertAfter(n,t,e){e||(e=t.parentNode);if(n instanceof Node){if(t===null||t===void 0){return e.insertBefore(n,t)}if(t instanceof Node){return e.insertBefore(n,t.nextSibling)}}return n}function nodeChanged(n,t){if(n===void 0||t===void 0){return!1}if(typeof n!==typeof t){return!0}if((typeof n==='string'||typeof n==='number')&&n!==t){return!0}if(n.type!==t.type){return!0}if(n.props){return!0}return!1}function autoUpdate(n,t){if(typeof n==='function'&&n.__radiStateUpdater){return n(t)}return t(n)}function setBooleanProp(n,t,e){e?(n.setAttribute(t,e),n[t]=!0):(n[t]=!1)}function removeBooleanProp(n,t){n.removeAttribute(t);n[t]=!1}function isEventProp(n){return /^on/.test(n)}function extractEventName(n){return n.slice(2).toLowerCase()}function isCustomProp(n){return isEventProp(n)}function setProp(n,t,e){t==='style'?setStyles(n,e):isCustomProp(t)||(t==='className'?n.setAttribute('class',e):typeof e==='boolean'?setBooleanProp(n,t,e):n.setAttribute(t,e))}function removeProp(n,t,e){isCustomProp(t)||(t==='className'?n.removeAttribute('class'):typeof e==='boolean'?removeBooleanProp(n,t):n.removeAttribute(t))}function setStyles(n,t){Object.keys(t).forEach(function(e){autoUpdate(t[e],function(t){n.style[e]=t})})}function setProps(n,t){Object.keys(t).forEach(function(e){autoUpdate(t[e],function(t){(e==='class'||e==='className')&&(Array.isArray(t)&&(t=t.filter(function(n){return n&&typeof n!=='function'}).join(' ')));setProp(n,e,t)})})}function updateProp(n,t,e,r){e?(!r||e!==r)&&setProp(n,t,e):removeProp(n,t,r)}function updateProps(n,t,e){e===void 0&&(e={});var r=Object.assign({},t,e);Object.keys(r).forEach(function(r){autoUpdate(t[r],function(t){updateProp(n,r,t,e[r])})})}function addEventListeners(n,t){var e=['mount','destroy'];Object.keys(t).forEach(function(r){isEventProp(r)&&n.addEventListener(extractEventName(r),function(o){e.indexOf(r)>=0?(n===o.target&&t[r](o)):t[r](o)},!1)})}function patch(n,t,e,r,o){r===void 0&&(r=0);var i=n&&n.childNodes[r];o&&(r=Array.prototype.indexOf.call(n.childNodes,o)+1);var u=flatten(ensureArray(t)),c=flatten(ensureArray(e)),l=u.length,a=c.length,s=0;for(var f=0;f<l||f<a;f++){u[f] instanceof Date&&(u[f]=u[f].toString());if(c[f]===!1||c[f]===void 0||c[f]===null)i=createElement$$1(u[f],n),o?insertAfter(i,n.childNodes[(r+f-1)],n):n.appendChild(i),fireEvent('mount',i);else if(u[f]===!1||u[f]===void 0||u[f]===null){var d=n.childNodes[r+f+s];d&&(n.removeChild(d),destroyTree$$1(d),s-=1)}else if(nodeChanged(u[f],c[f]))n.replaceChild(i=createElement$$1(u[f],n),n.childNodes[r+f]),fireEvent('mount',i);else if(typeof u[f].type==='string'){var p=u[f],h=c[f];updateProps(n.childNodes[r+f],p.props,h.props);var g=p.children.length,y=h.children.length;for(var m=0;m<g||m<y;m++)patch(n.childNodes[r+f],p.children[m],h.children[m],m)}}return u}function mount(n,t){return{component:n,node:patch(t,n),destroy:function(){return patch(t,null)}}}function createElement$$1(n,t){if(typeof n==='string'||typeof n==='number'){return document.createTextNode(n)}if(n===void 0||n===!1||n===null){return document.createComment('')}if(Array.isArray(n)){var e=document.createTextNode('');e.addEventListener('mount',function(){for(var e=0;e<n.length;e++)mount(n[e],t)});return e}if(typeof n==='function'||typeof n.type==='function'){var r=n.type||n,o=new Component(r),i=createElement$$1(r.call(o,Object.assign({},(n.props||{}),{children:n.children||[]})),t),u;i&&typeof i.addEventListener==='function'&&(i.addEventListener('mount',function(){typeof o.style==='string'&&(u=document.createElement('style'),u.innerHTML=o.style,document.head.appendChild(u));o.trigger('mount',i,t)},{passive:!0,once:!0},!1),i.addEventListener('destroy',function(){o.trigger('destroy',i,t);u instanceof Node&&document.head.removeChild(u)},{passive:!0,once:!0},!1));return i}if(typeof n==='object'){if(n.type){var c;n.type==='svg'||t instanceof SVGElement?(c=document.createElementNS('http://www.w3.org/2000/svg',n.type)):(c=document.createElement(n.type));var l=null;setProps(c,n.props);addEventListeners(c,n.props);var a=function(n){return function(t){var e=createElement$$1(t,n);e&&(l?insertAfter(e,l,n):(n.appendChild.call(c,e),fireEvent('mount',e)))}};n.children.map(a(c));return c}return createElement$$1(JSON.stringify(n),t)}console.error('Unhandled node',n);return null}function customAttribute(n,t,e){e===void 0&&(e={});var r=e.allowedTags,o=e.addToElement;return GLOBALS.CUSTOM_ATTRIBUTES[n]={name:n,caller:t,allowedTags:r||null,addToElement:o}}function customTag(n,t,e){return GLOBALS.CUSTOM_TAGS[n]={name:n,onmount:t||(function(){}),ondestroy:e||(function(){}),saved:null}}function html(n,t){var e=[],r=arguments.length-2;while(r-->0)e[r]=arguments[r+2];return{type:typeof n==='number'?""+n:n,props:t||{},children:flatten(e)}}function setDataInObject(n,t,e){var r=t[0],o={};o[r]=n[r];var i=o,u=0;while(u<t.length-1)i=i[t[u++]];i[t[u]]=e;return o}function mapData(n,t,e,r){r===void 0&&(r=[]);var o={};n&&n.$loading&&Object.defineProperty(o,'$loading',{value:!0,writable:!1});e||(e=o);var i=function(i){var u=i;typeof n[i]==='function'?(o[u]={},Object.defineProperty(o[u],'$loading',{value:!0,writable:!1}),n[i](function(n,o){var i=setDataInObject(e,r.concat(u),n);o?t.update(i):t.dispatch(function(){return i})})):(o[u]=n[u]&&typeof n[u]==='object'&&!Array.isArray(n[u])?mapData(n[u],t,e,r.concat(u)):n[u])};for(var u in n)i(u);return o}function Store(n){n===void 0&&(n={});var t={},e=[],r=[],o;Object.setPrototypeOf(t,{getInitial:function(){return i},get:function(){return o},update:function(n,i){var u=Object.assign({},o,mapData(n,t));o=u;i||r.map(function(n){typeof n==='function'&&n(u);return!1});e.map(function(n){typeof n==='function'&&n(u);return!1});return o},subscribe:function(n,t){t?r.push(n):e.push(n)},dispatch:function(n){var t=[],e=arguments.length-1;while(e-->0)t[e]=arguments[e+1];var r=n.apply(void 0,[o].concat(t));return this.update(r)},render:function(n){n===void 0&&(n=function(n){return JSON.stringify(n)});var t,r,i,u,c=!1;function l(e){i=n(e);patch(t,i,u,0,r);u=i;return e}e.push(function(n){c&&l(n);return n});function a(){this.onMount=function(n,e){c=!0;r=n;t=e||n.parentNode;l(o)};return''}return a},inject:function(n){if(typeof n!=='function'){console.warn('[Radi.js] Store\'s `.inject()` method must not be called on it\'s own. Instead use `{ field: Store.inject }`.');return!1}t.subscribe(n,!0);n(o,!0);return!0},out:function(n){var e;function r(r){if(typeof r==='function')t.subscribe(function(t){var o=n(t);e!==o&&r(o)}),r(e=n(o),!0);else{var i=t.render(n);return i}return e}r.__radiStateUpdater=!0;return r}});var i=mapData(n,t);o=i;return t}var Radi={v:GLOBALS.VERSION,version:GLOBALS.VERSION,h:html,html:html,Store:Store,customTag:customTag,customAttribute:customAttribute,patch:patch,mount:mount,service:service};Radi.plugin=function(n){var t=[],e=arguments.length-1;while(e-->0)t[e]=arguments[e+1];return n.apply(void 0,[Radi].concat(t))};window&&(window.Radi=Radi);export default Radi