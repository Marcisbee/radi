var GLOBALS={HEADLESS_COMPONENTS:{},FROZEN_STATE:!1,VERSION:'0.3.16',ACTIVE_COMPONENTS:{},HTML_CACHE:{}},Listener=function(e,...t){var n;this.component=e;(n=t, this.key=n[0]);this.childPath=t.slice(1,t.length);this.path=t;this.value=null;this.changeListeners=[];this.processValue=e=>e;this.attached=!0;this.component.addListener(this.key,this);this.component.state&&this.handleUpdate(this.component.state[this.key])};Listener.prototype.deattach=function(){this.component=null;this.attached=!1;this.key=null;this.childPath=null;this.path=null;this.value=null;this.changeListeners=[];this.processValue=()=>{}};Listener.prototype.handleUpdate=function(e){var t=this.processValue(this.getShallowValue(e),this.value);t instanceof Listener&&this.value instanceof Listener&&this.value.deattach();this.value=t;this.changeListeners.forEach(e=>e(this.value))};Listener.prototype.onValueChange=function(e){this.changeListeners.push(e);e(this.value)};Listener.prototype.process=function(e){this.processValue=e;this.handleUpdate(this.value);return this};Listener.prototype.getShallowValue=function(e){if(typeof e!=='object'||!this.childPath){return e}var t=e;for(var n of this.childPath)t===null||!t[n]&&typeof t[n]!=='number'?(t=null):(t=t[n]);return t};var AttributeListener=function(e){var t=e.attributeKey,n=e.listener,r=e.element;this.attributeKey=t;this.listener=n;this.element=r;this.attached=!1;this.handleValueChange=this.handleValueChange.bind(this)};AttributeListener.prototype.attach=function(){this.element.attributeListeners||(this.element.attributeListeners=[]);this.element.attributeListeners.push(this);this.listener.onValueChange(this.handleValueChange);this.attached=!0;this.attributeKey==='model'&&(/(checkbox|radio)/.test(this.element.getAttribute('type'))?this.element.addEventListener('change',e=>{this.listener.component.setState({[this.listener.key]:e.target.checked})}):this.element.addEventListener('input',e=>{this.listener.component.setState({[this.listener.key]:e.target.value})}));return this};AttributeListener.prototype.handleValueChange=function(e){this.attributeKey==='value'||this.attributeKey==='model'?(/(checkbox|radio)/.test(this.element.getAttribute('type'))?(this.element.checked=e):(this.element.value=e)):setAttributes(this.element,{[this.attributeKey]:e})};AttributeListener.prototype.updateElement=function(e){this.element=e;return this.element};AttributeListener.prototype.deattach=function(){this.attributeKey=null;this.listener.deattach();this.listener=null;this.element=null;this.listenerAsNode=null;this.attached=!1;this.handleValueChange=()=>{}};var StyleListener=function(e){var t=e.styleKey,n=e.listener,r=e.element;this.styleKey=t;this.listener=n;this.element=r;this.attached=!1;this.handleValueChange=this.handleValueChange.bind(this)};StyleListener.prototype.attach=function(){this.element.styleListeners||(this.element.styleListeners=[]);this.element.styleListeners.push(this);this.listener.onValueChange(this.handleValueChange);this.attached=!0;return this};StyleListener.prototype.handleValueChange=function(e){setStyle(this.element,this.styleKey,e)};StyleListener.prototype.updateElement=function(e){this.element=e;return this.element};StyleListener.prototype.deattach=function(){this.listener.deattach();this.styleKey=null;this.listener=null;this.element=null;this.attached=!1;this.handleValueChange=null};var parseValue=e=>typeof e==='number'&&!Number.isNaN(e)?`${e}px`:e,setStyle=(e,t,n)=>{if(typeof n==='undefined'){return void 0}if(n instanceof Listener){new StyleListener({styleKey:t,listener:n,element:e}).attach();return e[t]}return e.style[t]=parseValue(n)},setStyles=(e,t)=>{typeof t==='string'&&(e.style=t);if(typeof t!=='object'||Array.isArray(t)){return e.style}if(t instanceof Listener){new AttributeListener({attributeKey:'style',listener:t,element:e}).attach();return e.style}for(var n in t)setStyle(e,n,t[n]);return e.style},parseClass=e=>{if(Array.isArray(e)){return e.filter(e=>e).join(' ')}return e},setAttributes=(e,t)=>{var n=function(n){var r=t[n];if(typeof r==='undefined'){return}if(!r&&typeof r!=='number'){e.removeAttribute(n);return}if(n.toLowerCase()==='style'){setStyles(e,r);return}if(r instanceof Listener){new AttributeListener({attributeKey:n,listener:r,element:e}).attach();return}if(n.toLowerCase()==='class'||n.toLowerCase()==='classname'){e.setAttribute('class',parseClass(r));return}n.toLowerCase()==='loadfocus'&&(e.onload=e=>{setTimeout(()=>{e.focus()},10)});if(n.toLowerCase()==='html'){e.innerHTML=r;return}if(n.toLowerCase()==='model'){/(checkbox|radio)/.test(e.getAttribute('type'))?(e.onchange=e=>{r.component[r.key]=e.target.checked}):(e.oninput=e=>{r.component[r.key]=e.target.value},e.value=r.value);return}if(n.substring(0,2).toLowerCase()==='on'){n.substring(0,8).toLowerCase()==='onsubmit'?(e[n]=e=>{var t=[],n=e.target.elements||[];for(var a of n){if(a.name!==''&&(a.type!=='radio'&&a.type!=='checkbox')||a.checked){var o={name:a.name,el:a,type:a.type,default:a.defaultValue,value:a.value,set(e){this.el.value=e},reset(e){this.el.value=e;this.el.defaultValue=e}};t.push(o);t[o.name]||Object.defineProperty(t,o.name,{value:o})}}return r(e,t)}):(e[n]=r);return}e.setAttribute(n,r)};for(var r in t)n(r)},getElementFromQuery=(e,t)=>{if(typeof e==='string'||typeof e==='number'){return e!=='template'?t||e==='svg'?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e):document.createDocumentFragment()}console.warn('[Radi.js] Warn: Creating a JSX element whose query is not of type string, automatically converting query to string.');return document.createElement(e.toString())},generateId=()=>{var e='';for(var t=0;t<32;t++){var n=Math.random()*16|0;(t===8||t===12||t===16||t===20)&&(e+='-');e+=(t===12?4:t===16?n&3|8:n).toString(16)}return e},PrivateStore=function(){this.store={}};PrivateStore.prototype.addListener=function(e,t){typeof this.store[e]==='undefined'&&this.createItemWrapper(e);this.store[e].listeners=this.store[e].listeners.filter(e=>e.attached);this.store[e].listeners.push(t);t.handleUpdate(this.store[e].value);return t};PrivateStore.prototype.removeListeners=function(){var e=Object.keys(this.store);for(var t=0;t<e.length;t++)this.store[e[t]].listeners=[],this.store[e[t]].null=[]};PrivateStore.prototype.setState=function(e){for(var t of Object.keys(e))typeof this.store[t]==='undefined'&&this.createItemWrapper(t),this.store[t].value=e[t],this.triggerListeners(t);return e};PrivateStore.prototype.createItemWrapper=function(e){return this.store[e]={listeners:[],value:null}};PrivateStore.prototype.triggerListeners=function(e){var t=this.store[e];t&&t.listeners.forEach(e=>{e.attached&&e.handleUpdate(t.value)})};function getElementAttributes(e){return e.attributes}function fuseAttributes(e,t,n){var r=t.attributes;for(var a=0,o=r.length;a<o;a++){var l=r.item(a),s=l.namespaceURI,u=s?n.getNamedItemNS(s,l.name):n.getNamedItem(l.name);if(u&&u.name==='style'){for(var i of t.style)e.style[i]!==t.style[i]&&(e.style[i]=t.style[i]);continue}(!u||u.value!=l.value)&&(s?e.setAttributeNS(s,l.name,l.value):e.setAttribute(l.name,l.value))}for(var d=n.length;d;){var c=n.item(--d),p=c.namespaceURI;p?(r.getNamedItemNS(p,c.name)||e.removeAttributeNS(p,c.name)):(r.getNamedItem(c.name)||e.removeAttribute(c.name))}}var destroy=e=>{if(!(e instanceof Node)){return}var t=document.createTreeWalker(e,NodeFilter.SHOW_ALL,e=>!0,!1),n,r=[];while(n=t.nextNode()){if(n.listeners){for(var a=0;a<n.listeners.length;a++)n.listeners[a].deattach()}n.listeners=null;if(n.attributeListeners){for(a=0;a<n.attributeListeners.length;a++)n.attributeListeners[a].deattach()}n.attributeListeners=null;if(n.styleListeners){for(a=0;a<n.styleListeners.length;a++)n.styleListeners[a].deattach()}n.styleListeners=null;n.destroy&&n.destroy();r.push(function(){n&&n.parentNode&&n.parentNode.removeChild(n)})}if(e.listeners){for(a=0;a<e.listeners.length;a++)e.listeners[a].deattach()}e.listeners=null;if(e.attributeListeners){for(a=0;a<e.attributeListeners.length;a++)e.attributeListeners[a].deattach()}e.attributeListeners=null;if(e.styleListeners){for(a=0;a<e.styleListeners.length;a++)e.styleListeners[a].deattach()}e.styleListeners=null;e.styleListeners=null;e.destroy&&e.destroy();e.parentNode&&e.parentNode.removeChild(e);for(a=0;a<r.length;a++)r[a]();r=null};function same(e,t){if(e.id){return e.id===t.id}if(e.isSameNode){return e.isSameNode(t)}if(e.tagName!==t.tagName){return!1}if(e.type===3){return e.nodeValue===t.nodeValue}return!1}var fuse=(e,t,n)=>{(Array.isArray(t)||Array.isArray(e))&&(n=!0);if(!n){var r=e.nodeType,a=t.nodeType;if(r===a&&(r===3||a===8)){same(e,t)||(e.nodeValue=t.nodeValue,destroy(t));return e}if(t.destroy||e.destroy||t.__async||e.__async||e.listeners||t.listeners||r===3||a===3||r===1||a===1){same(e,t)||(e.parentNode.insertBefore(t,e),destroy(e));return t}fuseAttributes(e,t,getElementAttributes(e))}var o=[...e.childNodes||e],l=[...t.childNodes||t],s=Math.max(o.length,l.length);for(var u=0;u<s;u++)o[u]&&l[u]?fuse(o[u],l[u]):o[u]&&!l[u]?destroy(o[u]):!o[u]&&l[u]&&e.appendChild(l[u]);destroy(t);return e},FuseDom=function(){};FuseDom.prototype.fuse=function(...e){return fuse(...e)};FuseDom.prototype.destroy=function(...e){return destroy(...e)};var fuseDom=new FuseDom,clone=e=>{if(typeof e!=='object'){return e}if(e===null){return e}if(Array.isArray(e)){return e.map(clone)}var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=clone(e[n]));return t},skipInProductionAndTest=e=>{if(typeof process==='undefined'||(process.env.NODE_ENV==='production'||process.env.NODE_ENV==='test')){return!1}return e&&e()},Component=function(e,t){this.addNonEnumerableProperties({$id:generateId(),$name:this.constructor.name,$config:typeof this.config==='function'?this.config():{listen:!0},$events:{},$privateStore:new PrivateStore});this.on=typeof this.on==='function'?this.on():{};this.children=[];for(var n in GLOBALS.HEADLESS_COMPONENTS)this[n].when('update',()=>this.setState());this.state=Object.assign(typeof this.state==='function'?this.state():{},t||{});skipInProductionAndTest(()=>Object.freeze(this.state));e&&this.setChildren(e)};Component.prototype.render=function(e){if(typeof this.view!=='function'){return''}var t=this.view();if(Array.isArray(t)){for(var n=0;n<t.length;n++)typeof t[n].buildNode==='function'&&(t[n]=t[n].buildNode(e)),t[n].destroy=this.destroy.bind(this)}else typeof t.buildNode==='function'&&(t=t.buildNode(e)),t.destroy=this.destroy.bind(this);this.html=t;return t};Component.prototype.setProps=function(e){this.setState(e);return this};Component.prototype.setChildren=function(e){this.children=e;this.setState();for(var t=0;t<this.children.length;t++)typeof this.children[t].when==='function'&&this.children[t].when('update',()=>this.setState());return this};Component.prototype.addNonEnumerableProperties=function(e){for(var t in e){if(typeof this[t]!=='undefined'){continue}Object.defineProperty(this,t,{value:e[t]})}};Component.prototype.addListener=function(e,t){this.$privateStore.addListener(e,t)};Component.prototype.mount=function(){this.trigger('mount')};Component.prototype.destroy=function(){this.trigger('destroy');this.$privateStore.removeListeners()};Component.prototype.when=function(e,t){typeof this.$events[e]==='undefined'&&(this.$events[e]=[]);this.$events[e].push(t)};Component.prototype.trigger=function(e,...t){typeof this.on[e]==='function'&&this.on[e].call(this,...t);if(typeof this.$events[e]!=='undefined'){for(var n in this.$events[e])this.$events[e][n].call(this,...t)}};Component.prototype.setState=function(e){if(typeof e==='object'){var t=this.state;skipInProductionAndTest(()=>t=clone(this.state));this.state=Object.assign(t,e);skipInProductionAndTest(()=>Object.freeze(this.state));this.$config.listen&&this.$privateStore.setState(e)}!this.$config.listen&&typeof this.view==='function'&&this.html&&fuseDom.fuse(this.html,this.view());this.trigger('update');return e};Component.isComponent=function(){return!0};var mount=(e,t,n)=>{var r=typeof t==='string'?document.getElementById(t):t;n=n||r instanceof SVGElement;var a=e instanceof Component||e.render?e.render(n):e;if(Array.isArray(a)){for(var o=0;o<a.length;o++)mount(a[o],r,n)}else appendChild(r,n)(a);typeof r.destroy!=='function'&&(r.destroy=()=>{for(var e=0;e<a.length;e++)fuseDom.destroy(a[e])});typeof e.mount==='function'&&e.mount();return r},ensureArray=e=>{if(Array.isArray(e)){return e}return[e]},listenerToNode=(e,t)=>{if(e instanceof DocumentFragment){return Array.from(e.childNodes)}var n=document.createDocumentFragment();appendChildren(n,ensureArray(e),t);return listenerToNode(n)},insertAfter=(e,t)=>(e.parentNode.insertBefore(t,e.nextSibling)),ElementListener=function(e){var t=e.listener,n=e.element;this.listener=t;this.element=n;this.listenerAsNode=[];this.attached=!1;this.handleValueChange=this.handleValueChange.bind(this)};ElementListener.prototype.attach=function(){this.element.listeners||(this.element.listeners=[]);this.element.listeners.push(this);this.listener.onValueChange(this.handleValueChange);this.attached=!0;return this};ElementListener.prototype.handleValueChange=function(e){var t=listenerToNode(e,this.element instanceof SVGElement),n=0;for(var r of t)this.listenerAsNode[n]?(this.listenerAsNode[n]=fuseDom.fuse(this.listenerAsNode[n],r)):(this.listenerAsNode[n-1]?(this.listenerAsNode.push(r),insertAfter(this.listenerAsNode[n-1],r)):this.listenerAsNode.push(this.element.appendChild(r))),n+=1;if(n<this.listenerAsNode.length){var a=this.listenerAsNode.splice(n-this.listenerAsNode.length);for(var o of a)fuseDom.destroy(o)}};ElementListener.prototype.updateElement=function(e){this.element=e;return this.element};ElementListener.prototype.deattach=function(){this.listener.deattach();this.listener=null;this.element=null;this.listenerAsNode=null;this.attached=!1;this.handleValueChange=()=>{}};var appendListenerToElement=(e,t)=>new ElementListener({listener:e,element:t}).attach(),appendChild=(e,t)=>n=>{!n&&typeof n!=='number'&&(n='');if(typeof n.buildNode==='function'){appendChild(e,t)(n.buildNode(t));return}if(n instanceof Component){mount(n,e,t);return}if(n.isComponent){mount(new n,e,t);return}if(n instanceof Listener){appendListenerToElement(n,e);return}if(Array.isArray(n)){appendChildren(e,n,t);return}if(typeof n==='function'){appendChild(e,t)(n());return}if(n instanceof Promise||n.constructor.name==='LazyPromise'){var r=document.createElement('section');r.__async=!0;var a=e.appendChild(r);n.then(e=>{e.default?appendChild(a,t)(e.default):appendChild(a,t)(e)}).catch(console.warn);return}if(n instanceof Node){e.appendChild(n);return}e.appendChild(document.createTextNode(n))},appendChildren=(e,t,n)=>{t.forEach(appendChild(e,n))},htmlCache={},svgCache={},memoizeHTML=e=>htmlCache[e]||(htmlCache[e]=getElementFromQuery(e,!1)),memoizeSVG=e=>svgCache[e]||(svgCache[e]=getElementFromQuery(e,!0)),buildNode=(e,t,n,...r)=>{if(typeof t==='function'&&t.isComponent){return new t(r).setProps(n||{})}if(typeof t==='function'){var a=n||{};a.children=r;return t(a)}var o=e||t==='svg',l=(o?memoizeSVG(t):memoizeHTML(t)).cloneNode(!1);n!==null&&setAttributes(l,n);appendChildren(l,r,o);l.onload&&l.onload(l);return l},buildNode$1={html:(...e)=>buildNode(!1,...e),svg:(...e)=>buildNode(!0,...e)},r=(e,t,...n)=>({buildNode:r=>buildNode$1[r?'svg':'html'](e,t,...n)}),listen=(e,...t)=>new Listener(e,...t),remountActiveComponents=()=>{Object.values(GLOBALS.ACTIVE_COMPONENTS).forEach(e=>{typeof e.onMount==='function'&&e.onMount(e)})};function createWorker(e){var t=()=>{},n=new Blob([`self.onmessage = function(e) {
    self.postMessage((${e.toString()})(e.data));
  }`],{type:'text/javascript'}),r=window.URL.createObjectURL(n),a=new Worker(r);a.onmessage=e=>{t(e.data,null)};a.onerror=e=>{t(null,e.data)};return e=>new Promise((n,r)=>{t=(e,t)=>!t?n(e):r(e),a.postMessage(e)})}function worker(e,t,n){var r=n.value,a=createWorker(r);n.value=function(...e){a(...e).then(e=>{this.setState.call(this,e)})};return n}function action(e,t,n){var r=n.value;n.value=function(...e){return this.setState.call(this,r.call(this,...e))};return n}function subscribe(e,t,n){return function(n,r,a){var o='on'+(t||r),l=function(...e){return a.value.call(this,...e)};e[o]=l;return a}}var Radi={version:GLOBALS.VERSION,activeComponents:GLOBALS.ACTIVE_COMPONENTS,r,listen,l:listen,worker,component:Component,Component,action,subscribe,headless:(e,t)=>{var n='$'.concat(e),r=new t;r.mount();Component.prototype[n]=r;return GLOBALS.HEADLESS_COMPONENTS[n]=r},mount,freeze:()=>{GLOBALS.FROZEN_STATE=!0},unfreeze:()=>{GLOBALS.FROZEN_STATE=!1,remountActiveComponents()}};Radi.plugin=(e,...t)=>e(Radi,...t);window&&(window.Radi=Radi);export default Radi