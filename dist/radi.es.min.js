var GLOBALS={VERSION:'0.5.0',CUSTOM_ATTRIBUTES:{},CUSTOM_TAGS:{},SERVICES:{}};function capitalise(n){return n.charAt(0).toUpperCase()+n.substr(1)}function ensureArray(n){if(arguments.length===0){return[]}if(arguments.length===1){if(n===void 0||n===null){return[]}if(Array.isArray(n)){return n}}return Array.prototype.slice.call(arguments)}function flatten(n){return n.reduce(function(n,t){return n.concat(Array.isArray(t)?flatten(t):t)},[])}var Component=function(n,t){this.self=n;this.name=t||n.name;this.__$events={}};Component.prototype.on=function(n,t){var e=this.__$events,r="on"+(capitalise(n));e[r]||(e[r]=[]);e[r].push(t);return t};Component.prototype.trigger=function(n){var t,e,r=[],u=arguments.length-1;while(u-->0)r[u]=arguments[u+1];var o="on"+(capitalise(n));(this.__$events[o]||[]).map(function(n){return n.apply(void 0,r)});typeof this[o]==='function'&&(t=this)[o].apply(t,r);typeof this.self[o]==='function'&&(e=this.self)[o].apply(e,r)};function service(n,t){var e=[],r=arguments.length-2;while(r-->0)e[r]=arguments[r+2];if(typeof n!=='string'){throw new Error('[Radi.js] Service first argument has to be string')}if(typeof t!=='function'){throw new Error('[Radi.js] Service second argument has to be function')}var u='$'.concat(n),o=t.apply(void 0,e);Component.prototype[u]=o;return GLOBALS.SERVICES[u]=o}function destroyTree$$1(n){fireEvent('destroy',n);if(n.nodeType===1){var t=n.firstChild;while(t)destroyTree$$1(t),t=t.nextSibling}}function fireEvent(n,t){var e=document.createEvent('Event');e.initEvent(n,!0,!0);typeof t.dispatchEvent==='function'&&(t._eventFired=!0,t.dispatchEvent(e));return t}function insertAfter(n,t,e){e||(e=t.parentNode);if(n instanceof Node){if(t===null||t===void 0){return e.insertBefore(n,t)}if(t instanceof Node){return e.insertBefore(n,t.nextSibling)}}return n}function nodeChanged(n,t){if(n===void 0||t===void 0){return!1}if(typeof n!==typeof t){return!0}if((typeof n==='string'||typeof n==='number')&&n!==t){return!0}if(n.type!==t.type){return!0}if(n.props){return!0}return!1}function autoUpdate(n,t){if(typeof n==='function'&&n.__radiStateUpdater){return n(t)}return t(n)}function setBooleanProp(n,t,e){e?(n.setAttribute(t,e),n[t]=!0):(n[t]=!1)}function removeBooleanProp(n,t){n.removeAttribute(t);n[t]=!1}function isEventProp(n){return /^on/.test(n)}function extractEventName(n){return n.slice(2).toLowerCase()}function isCustomProp(n){return isEventProp(n)}function setProp(n,t,e){t==='style'?setStyles(n,e):isCustomProp(t)||(t==='className'?n.setAttribute('class',e):typeof e==='boolean'?setBooleanProp(n,t,e):n.setAttribute(t,e))}function removeProp(n,t,e){isCustomProp(t)||(t==='className'?n.removeAttribute('class'):typeof e==='boolean'?removeBooleanProp(n,t):n.removeAttribute(t))}function setStyles(n,t){Object.keys(t).forEach(function(e){autoUpdate(t[e],function(t){n.style[e]=t})})}function setProps(n,t){Object.keys(t).forEach(function(e){autoUpdate(t[e],function(t){(e==='class'||e==='className')&&(Array.isArray(t)&&(t=t.filter(function(n){return n&&typeof n!=='function'}).join(' ')));setProp(n,e,t)})})}function updateProp(n,t,e,r){e?(!r||e!==r)&&setProp(n,t,e):removeProp(n,t,r)}function updateProps(n,t,e){e===void 0&&(e={});var r=Object.assign({},t,e);Object.keys(r).forEach(function(r){autoUpdate(t[r],function(t){updateProp(n,r,t,e[r])})})}function addEventListeners(n,t){var e=['mount','destroy'];Object.keys(t).forEach(function(r){isEventProp(r)&&n.addEventListener(extractEventName(r),function(u){e.indexOf(r)>=0?(n===u.target&&t[r](u)):t[r](u)},!1)})}function patch(n,t,e,r,u){r===void 0&&(r=0);var o=n&&n.childNodes[r];u&&(r=Array.prototype.indexOf.call(n.childNodes,u)+1);var i=flatten(ensureArray(t)),c=flatten(ensureArray(e)),l=i.length,f=c.length,s=0;for(var a=0;a<l||a<f;a++){i[a] instanceof Date&&(i[a]=i[a].toString());if(c[a]===!1||c[a]===void 0||c[a]===null)o=createElement$$1(i[a],n),u?insertAfter(o,n.childNodes[(r+a-1)],n):n.appendChild(o),fireEvent('mount',o);else if(i[a]===!1||i[a]===void 0||i[a]===null){var d=n.childNodes[r+a+s];d&&(n.removeChild(d),destroyTree$$1(d),s-=1)}else if(nodeChanged(i[a],c[a]))n.replaceChild(o=createElement$$1(i[a],n),n.childNodes[r+a]),fireEvent('mount',o);else if(typeof i[a].type==='string'){var p=i[a],h=c[a];updateProps(n.childNodes[r+a],p.props,h.props);var g=p.children.length,y=h.children.length;for(var m=0;m<g||m<y;m++)patch(n.childNodes[r+a],p.children[m],h.children[m],m)}}return i}function mount(n,t){return{component:n,node:patch(t,n),destroy:function(){return patch(t,null,n)}}}function createElement$$1(n,t){if(typeof n==='string'||typeof n==='number'){return document.createTextNode(n)}if(n===void 0||n===!1||n===null){return document.createComment('')}if(Array.isArray(n)){var e=document.createTextNode('');e.addEventListener('mount',function(){for(var e=0;e<n.length;e++)mount(n[e],t)});return e}if(typeof n==='function'||typeof n.type==='function'){var r=n.type||n,u=new Component(r),o=createElement$$1(r.call(u,Object.assign({},(n.props||{}),{children:n.children||[]})),t),i;o&&typeof o.addEventListener==='function'&&(o.addEventListener('mount',function(){typeof u.style==='string'&&(i=document.createElement('style'),i.innerHTML=u.style,document.head.appendChild(i));u.trigger('mount',o,t)},{passive:!0,once:!0},!1),o.addEventListener('destroy',function(){u.trigger('destroy',o,t);i instanceof Node&&document.head.removeChild(i)},{passive:!0,once:!0},!1));return o}if(typeof n==='object'){if(n.type){var c;n.type==='svg'||t instanceof SVGElement?(c=document.createElementNS('http://www.w3.org/2000/svg',n.type)):(c=document.createElement(n.type));var l=null;setProps(c,n.props);addEventListeners(c,n.props);var f=function(n){return function(t){var e=createElement$$1(t,n);e&&(l?insertAfter(e,l,n):(n.appendChild.call(c,e),fireEvent('mount',e)))}};n.children.map(f(c));return c}return createElement$$1(JSON.stringify(n),t)}console.error('Unhandled node',n);return null}function customAttribute(n,t,e){e===void 0&&(e={});var r=e.allowedTags,u=e.addToElement;return GLOBALS.CUSTOM_ATTRIBUTES[n]={name:n,caller:t,allowedTags:r||null,addToElement:u}}function customTag(n,t){return GLOBALS.CUSTOM_TAGS[n]={name:n,render:t||(function(){})}}function html(n,t){var e=[],r=arguments.length-2;while(r-->0)e[r]=arguments[r+2];var u=n;typeof GLOBALS.CUSTOM_TAGS[n]!=='undefined'&&(u=GLOBALS.CUSTOM_TAGS[n].render);return{type:typeof u==='number'?u+'':u,props:t||{},children:flatten(e)}}function setDataInObject(n,t,e){var r=t[0],u={};u[r]=n[r];var o=u,i=0;while(i<t.length-1)o=o[t[i++]];o[t[i]]=e;return u}function mapData(n,t,e,r){r===void 0&&(r=[]);var u={};n&&n.$loading&&Object.defineProperty(u,'$loading',{value:!0,writable:!1});e||(e=u);var o=function(o){var i=o;if(typeof n[o]==='function'){var c=n[o](function(n,u){var o=setDataInObject(e,r.concat(i),n);u?t.update(o):t.dispatch(function(){return o})});u[i]=typeof c==='object'?c:{};Object.defineProperty(u[i],'$loading',{value:!0,writable:!1})}else u[i]=n[i]&&typeof n[i]==='object'&&!Array.isArray(n[i])?mapData(n[i],t,e,r.concat(i)):n[i]};for(var i in n)o(i);return u}function Store(n){n===void 0&&(n={});var t={},e=[],r=[],u;Object.setPrototypeOf(t,{getInitial:function(){return o},get:function(){return u},update:function(n,o){var i=Object.assign({},u,mapData(n,t));u=i;o||r.map(function(n){typeof n==='function'&&n(i);return!1});e.map(function(n){typeof n==='function'&&n(i);return!1});return u},subscribe:function(n,t){t?r.push(n):e.push(n)},dispatch:function(n){var t=[],e=arguments.length-1;while(e-->0)t[e]=arguments[e+1];var r=n.apply(void 0,[u].concat(t));return this.update(r)},render:function(n){n===void 0&&(n=function(n){return JSON.stringify(n)});var t,r,o,i,c=!1;function l(e){o=n(e);patch(t,o,i,0,r);i=o;return e}e.push(function(n){c&&l(n);return n});function f(){this.onMount=function(n,e){c=!0;r=n;t=e||n.parentNode;l(u)};return''}return f},inject:function(n){if(typeof n!=='function'){console.warn('[Radi.js] Store\'s `.inject()` method must not be called on it\'s own. Instead use `{ field: Store.inject }`.');return}t.subscribe(n,!0);n(u,!0);return u},out:function(n){var e;function r(r){if(typeof r==='function')t.subscribe(function(t){var u=n(t);e!==u&&r(u)}),r(e=n(u),!0);else{var o=t.render(n);return o}return e}r.__radiStateUpdater=!0;return r}});var o=mapData(n,t);u=o;return t}function Subscribe(n){n===void 0&&(n=document);return{on:function(t,e){e===void 0&&(e=function(n){return n});var r=null,u=null,o=null,i=!1,c=typeof e==='object'?function(n){return(Object.keys(e).reduce(function(t,e){var r;return(Object.assign({},t,(r={}, r[e]=n[e], r)))},{}))}:e;if(typeof c!=='function'){throw new Error('[Radi.js] Subscription `'+t+'` must be transformed by function');return}function l(e){return function(l){i=!0;u=e;o=l;n.addEventListener(t,r=function(){var n=[],t=arguments.length;while(t--)n[t]=arguments[t];return l(c.apply(void 0,n))});return e}}l.stop=function(){return i&&(n.removeEventListener(t,r), i=!i)};l.start=function(){return!i&&l(u)(o)};return l}}}var Portal=customTag('portal',function(n){var t,e,r=n.children||[];this.onMount=function(u){mount(function(){this.onMount=function(n,r){t=n;e=r};return function(){return r}},n.on||document.body)};this.onDestroy=function(n,u){patch(e,null,r,0,t||n)};return null}),Radi={v:GLOBALS.VERSION,version:GLOBALS.VERSION,h:html,html:html,Store:Store,customTag:customTag,customAttribute:customAttribute,patch:patch,mount:mount,service:service,Subscribe:Subscribe};Radi.plugin=function(n){var t=[],e=arguments.length-1;while(e-->0)t[e]=arguments[e+1];return n.apply(void 0,[Radi].concat(t))};window&&(window.Radi=Radi);export default Radi