var GLOBALS={HEADLESS_COMPONENTS:{},FROZEN_STATE:!1,VERSION:'0.3.3',ACTIVE_COMPONENTS:{},HTML_CACHE:{}},copyAttrs=function(e,t){var n=t.attributes,r=e.attributes,l=null,o=null,u=null,a=null,i=null;for(var s=r.length-1;s>=0;--s)i=r[s],a=i.name,l=i.namespaceURI,o=i.value,l?(a=i.localName||a,u=t.getAttributeNS(l,a),u!==o&&t.setAttributeNS(l,a,o)):(t.hasAttribute(a)?(u=t.getAttribute(a),u!==o&&(o==='null'||o==='undefined'?t.removeAttribute(a):t.setAttribute(a,o))):t.setAttribute(a,o));for(var c=n.length-1;c>=0;--c)i=n[c],i.specified!==!1&&(a=i.name,l=i.namespaceURI,l?(a=i.localName||a,e.hasAttributeNS(l,a)||t.removeAttributeNS(l,a)):(e.hasAttributeNS(null,a)||t.removeAttribute(a)))},destroy=function(e){if(!(e instanceof Node)){return}var t=document.createTreeWalker(e,NodeFilter.SHOW_ALL,function(e){return!0},!1),n;while(n=t.nextNode()){if(n.listeners){for(var r=0;r<n.listeners.length;r++)n.listeners[r].deattach()}n.listeners=null;if(n.attributeListeners){for(r=0;r<n.styleListeners.length;r++)n.styleListeners[r].deattach()}n.attributeListeners=null;if(n.styleListeners){for(r=0;r<n.styleListeners.length;r++)n.styleListeners[r].deattach()}n.styleListeners=null;n.destroy&&n.destroy();n.remove()}if(e.listeners){for(r=0;r<e.listeners.length;r++)e.listeners[r].deattach()}e.listeners=null;if(e.attributeListeners){for(r=0;r<e.styleListeners.length;r++)e.styleListeners[r].deattach()}e.attributeListeners=null;if(e.styleListeners){for(r=0;r<e.styleListeners.length;r++)e.styleListeners[r].deattach()}e.remove()},fuse=function(e,t,n){(Array.isArray(t)||Array.isArray(e))&&(n=!0);if(!n){var r=e.nodeType,l=t.nodeType;if(r===l&&(r===3||l===8)){e.isEqualNode(t)||(e.nodeValue=t.nodeValue,destroy(t));return e}if(t.destroy||e.destroy||t.__async||t.__async||e.listeners||t.listeners||r===3||l===3){e.isEqualNode(t)||(e.parentNode.insertBefore(t,e),destroy(e));return t}copyAttrs(t,e)}var o=[].concat(e.childNodes||e),u=[].concat(t.childNodes||t),a=Math.max(o.length,u.length);for(var i=0;i<a;i++)o[i]&&u[i]?fuse(o[i],u[i]):o[i]&&!u[i]?destroy(o[i]):!o[i]&&u[i]&&e.appendChild(u[i]);destroy(t);return e},FuseDom=function(){};FuseDom.prototype.fuse=function(){var e=[],t=arguments.length;while(t--)e[t]=arguments[t];return fuse.apply(void 0,e)};FuseDom.prototype.destroy=function(){var e=[],t=arguments.length;while(t--)e[t]=arguments[t];return destroy.apply(void 0,e)};var fuseDom=new FuseDom,Listener=function(e){var t,n=[],r=arguments.length-1;while(r-->0)n[r]=arguments[r+1];this.component=e;(t=n, this.key=t[0]);this.childPath=n.slice(1,n.length);this.path=n;this.value=null;this.changeListeners=[];this.processValue=function(e){return e};this.attatched=!0;this.component.addListener(this.key,this);this.component.state&&this.handleUpdate(this.component.state[this.key])};Listener.prototype.deattach=function(){this.component=null;this.attatched=!1;this.key=null;this.childPath=null;this.path=null;this.value=null;this.changeListeners=[];this.processValue=function(){}};Listener.prototype.handleUpdate=function(e){var t=this;this.value instanceof Node&&(fuseDom.destroy(this.value),this.value=null);this.value=this.processValue(this.getShallowValue(e),this.value);this.changeListeners.forEach(function(e){return e(t.value)})};Listener.prototype.onValueChange=function(e){this.changeListeners.push(e);e(this.value)};Listener.prototype.process=function(e){this.processValue=e;this.handleUpdate(this.value);return this};Listener.prototype.getShallowValue=function(e){var t=this;if(typeof e!=='object'||!this.childPath){return e}var n=e;for(var r of t.childPath)n===null||!n[r]&&typeof n[r]!=='number'?(n=null):(n=n[r]);return n};var AttributeListener=function(e){var t=e.attributeKey,n=e.listener,r=e.element;this.attributeKey=t;this.listener=n;this.element=r;this.attached=!1;this.handleValueChange=this.handleValueChange.bind(this)};AttributeListener.prototype.attach=function(){var e=this;this.element.attributeListeners||(this.element.attributeListeners=[]);this.element.attributeListeners.push(this);this.listener.onValueChange(this.handleValueChange);this.attached=!0;this.attributeKey==='model'&&(/(checkbox|radio)/.test(this.element.getAttribute('type'))?(this.element.onchange=function(t){e.listener.component[e.listener.key]=t.target.checked}):(this.element.oninput=function(t){e.listener.component[e.listener.key]=t.target.value}));return this};AttributeListener.prototype.handleValueChange=function(e){var t;this.attributeKey==='value'||this.attributeKey==='model'?(/(checkbox|radio)/.test(this.element.getAttribute('type'))?(this.element.checked=e):(this.element.value=e)):setAttributes(this.element,(t={}, t[this.attributeKey]=e, t))};AttributeListener.prototype.updateElement=function(e){this.element=e;return this.element};AttributeListener.prototype.deattach=function(){this.attributeKey=null;this.listener.deattach();this.listener=null;this.element=null;this.listenerAsNode=null;this.attached=!1;this.handleValueChange=function(){}};var StyleListener=function(e){var t=e.styleKey,n=e.listener,r=e.element;this.styleKey=t;this.listener=n;this.element=r;this.attached=!1;this.handleValueChange=this.handleValueChange.bind(this)};StyleListener.prototype.attach=function(){this.element.styleListeners||(this.element.styleListeners=[]);this.element.styleListeners.push(this);this.listener.onValueChange(this.handleValueChange);this.attached=!0;return this};StyleListener.prototype.handleValueChange=function(e){setStyle(this.element,this.styleKey,e)};StyleListener.prototype.updateElement=function(e){this.element=e;return this.element};StyleListener.prototype.deattach=function(){this.listener.deattach();this.styleKey=null;this.listener=null;this.element=null;this.attached=!1;this.handleValueChange=null};var parseValue=function(e){return typeof e==='number'&&!Number.isNaN(e)?e+"px":e},setStyle=function(e,t,n){if(typeof n==='undefined'){return void 0}if(n instanceof Listener){new StyleListener({styleKey:t,listener:n,element:e}).attach();return e[t]}return e.style[t]=parseValue(n)},setStyles=function(e,t){typeof t==='string'&&(e.style=t);if(typeof t!=='object'||Array.isArray(t)){return e.style}if(t instanceof Listener){new AttributeListener({attributeKey:'style',listener:t,element:e}).attach();return e.style}for(var n in t)setStyle(e,n,t[n]);return e.style},parseClass=function(e){if(Array.isArray(e)){return e.filter(function(e){return e}).join(' ')}return e},setAttributes=function(e,t){var n=function(n){var r=t[n];if(typeof r==='undefined'){return}if(!r&&typeof r!=='number'){e.removeAttribute(n);return}if(n.toLowerCase()==='style'){setStyles(e,r);return}if(r instanceof Listener){new AttributeListener({attributeKey:n,listener:r,element:e}).attach();return}if(n.toLowerCase()==='class'||n.toLowerCase()==='classname'){e.setAttribute('class',parseClass(r));return}if(n.substring(0,2).toLowerCase()==='on'){n.substring(0,8).toLowerCase()==='onsubmit'?(e[n]=function(e){var t=[],n=e.target.elements||[];for(var l of n){if(l.name!==''){var o={name:l.name,el:l,type:l.type,default:l.defaultValue,value:l.value,set:function(e){this.el.value=e},reset:function(e){this.el.value=e;this.el.defaultValue=e}};t.push(o);Object.defineProperty(t,o.name,{value:o})}}return r(e,t)}):(e[n]=r);return}e.setAttribute(n,r)};for(var r in t)n(r)},getElementFromQuery=function(e){if(typeof e==='string'){return e!=='template'?document.createElement(e):document.createDocumentFragment()}console.warn('[Radi.js] Warn: Creating a JSX element whose query is not of type string, automatically converting query to string.');return document.createElement(e.toString())},generateId=function(){var e='';for(var t=0;t<32;t++){var n=Math.random()*16|0;(t===8||t===12||t===16||t===20)&&(e+='-');e+=(t===12?4:t===16?n&3|8:n).toString(16)}return e},PrivateStore=function(){this.store={}};PrivateStore.prototype.addListener=function(e,t){typeof this.store[e]==='undefined'&&this.createItemWrapper(e);this.store[e].listeners=this.store[e].listeners.filter(function(e){return e.attatched});this.store[e].listeners.push(t);t.handleUpdate(this.store[e].value);return t};PrivateStore.prototype.removeListeners=function(){var e=this,t=Object.keys(this.store);for(var n=0;n<t.length;n++)e.store[t[n]].listeners=[],e.store[t[n]].null=[]};PrivateStore.prototype.setState=function(e){var t=this;for(var n of Object.keys(e))typeof t.store[n]==='undefined'&&t.createItemWrapper(n),t.store[n].value=e[n],t.triggerListeners(n);return e};PrivateStore.prototype.createItemWrapper=function(e){return this.store[e]={listeners:[],value:null}};PrivateStore.prototype.triggerListeners=function(e){var t=this.store[e];t&&t.listeners.forEach(function(e){return e.handleUpdate(t.value)})};var clone=function(e){if(typeof e!=='object'){return e}if(e===null){return e}if(Array.isArray(e)){return e.map(clone)}var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=clone(e[n]));return t},skipInProductionAndTest=function(e){if(process.env.NODE_ENV==='production'||process.env.NODE_ENV==='test'){return!1}return e&&e()},Component=function(e,t){var n=this;this.addNonEnumerableProperties({$id:generateId(),$name:this.constructor.name,$config:typeof this.config==='function'?this.config():{listen:!0},$events:{},$privateStore:new PrivateStore});this.on=typeof this.on==='function'?this.on():{};this.children=[];this.copyObjToInstance(GLOBALS.HEADLESS_COMPONENTS,'head');this.state=Object.assign(typeof this.state==='function'?this.state():{},t||{});skipInProductionAndTest(function(){return Object.freeze(n.state)});e&&this.setChildren(e)};Component.prototype.render=function(){var e=this;if(typeof this.view!=='function'){return''}var t=this.view();if(Array.isArray(t)){for(var n=0;n<t.length;n++)t[n].destroy=e.destroy.bind(e)}else t.destroy=this.destroy.bind(this);this.html=t;return t};Component.prototype.setProps=function(e){this.setState(e);return this};Component.prototype.setChildren=function(e){var t=this;this.children=e;this.setState();for(var n=0;n<this.children.length;n++)typeof t.children[n].when==='function'&&t.children[n].when('update',function(){return t.setState()});return this};Component.prototype.copyObjToInstance=function(e,t){var n=this;for(var r in e){if(typeof n[r]!=='undefined'){throw new Error(("[Radi.js] Error: Trying to write for reserved variable `"+r+"`"))}n[r]=e[r];t==='head'&&n[r].when('update',function(){return n.setState()})}};Component.prototype.addNonEnumerableProperties=function(e){var t=this;for(var n in e){if(typeof t[n]!=='undefined'){continue}Object.defineProperty(t,n,{value:e[n]})}};Component.prototype.addListener=function(e,t){this.$privateStore.addListener(e,t)};Component.prototype.mount=function(){this.trigger('mount')};Component.prototype.destroy=function(){this.trigger('destroy');this.html&&this.html!==''&&typeof this.html.remove==='function'&&this.html.remove();this.$privateStore.removeListeners()};Component.prototype.when=function(e,t){typeof this.$events[e]==='undefined'&&(this.$events[e]=[]);this.$events[e].push(t)};Component.prototype.trigger=function(e){var t=this,n,r,l=[],o=arguments.length-1;while(o-->0)l[o]=arguments[o+1];typeof this.on[e]==='function'&&(n=this.on[e]).call.apply(n,[this].concat(l));if(typeof this.$events[e]!=='undefined'){for(var u in t.$events[e])(r=t.$events[e][u]).call.apply(r,[t].concat(l))}};Component.prototype.setState=function(e){var t=this;if(typeof e==='object'){var n=clone(this.state);this.state=Object.assign(n,e);skipInProductionAndTest(function(){return Object.freeze(t.state)});this.$config.listen&&this.$privateStore.setState(e)};!this.$config.listen&&typeof this.view==='function'&&this.html&&fuseDom.fuse(this.html,this.view());this.trigger('update');return this.state};Component.isComponent=function(){return!0};var mount=function(e,t){var n=document.createDocumentFragment(),r=typeof t==='string'?document.getElementById(t):t,l=e instanceof Component||e.render?e.render():e;if(Array.isArray(l)){for(var o=0;o<l.length;o++)mount(l[o],n)}else appendChild(n)(l);r.appendChild(n);typeof r.destroy!=='function'&&(r.destroy=function(){for(var e=0;e<l.length;e++)fuseDom.destroy(l[e])});typeof e.mount==='function'&&e.mount();return r},ensureArray=function(e){if(Array.isArray(e)){return e}return[e]},listenerToNode=function(e){if(e instanceof DocumentFragment){return Array.from(e.childNodes)}var t=document.createDocumentFragment();appendChildren(t,ensureArray(e));return listenerToNode(t)},ElementListener=function(e){var t=e.listener,n=e.element;this.listener=t;this.element=n;this.listenerAsNode=[];this.attached=!1;this.handleValueChange=this.handleValueChange.bind(this)};ElementListener.prototype.attach=function(){this.element.listeners||(this.element.listeners=[]);this.element.listeners.push(this);this.listener.onValueChange(this.handleValueChange);this.attached=!0;return this};ElementListener.prototype.handleValueChange=function(e){var t=this,n=listenerToNode(e),r=0;for(var l of n)t.listenerAsNode[r]?(t.listenerAsNode[r]=fuseDom.fuse(t.listenerAsNode[r],l)):t.listenerAsNode.push(t.element.appendChild(l)),r+=1;if(r<this.listenerAsNode.length){var o=this.listenerAsNode.splice(r-this.listenerAsNode.length);for(var u of o)fuseDom.destroy(u)}};ElementListener.prototype.updateElement=function(e){this.element=e;return this.element};ElementListener.prototype.deattach=function(){this.listener.deattach();this.listener=null;this.element=null;this.listenerAsNode=null;this.attached=!1;this.handleValueChange=function(){}};var appendListenerToElement=function(e,t){return new ElementListener({listener:e,element:t}).attach()},appendChild=function(e){return function(t){!t&&typeof t!=='number'&&(t='');if(t instanceof Component){mount(t,e);return}if(t instanceof Listener){appendListenerToElement(t,e);return}if(Array.isArray(t)){appendChildren(e,t);return}if(typeof t==='function'){var n=document.createElement('div'),r=e.appendChild(n);r.__async=!0;t().then(function(e){typeof e.default==='function'&&e.default.isComponent&&e.default.isComponent()?appendChild(r)(new e.default):appendChild(r)(e.default)}).catch(console.warn);return}if(t instanceof Node){e.appendChild(t);return}e.appendChild(document.createTextNode(t))}},appendChildren=function(e,t){t.forEach(appendChild(e))},r=function(e,t){var n=[],r=arguments.length-2;while(r-->0)n[r]=arguments[r+2];if(typeof e==='function'&&e.isComponent){return new e(n).setProps(t||{})}if(typeof e==='function'){var l=t||{};l.children=n;return e(l)}var o=getElementFromQuery(e);t!==null&&setAttributes(o,t);appendChildren(o,n);return o},listen=function(e){var t=[],n=arguments.length-1;while(n-->0)t[n]=arguments[n+1];return new (Function.prototype.bind.apply(Listener,[null].concat([e],t)))},remountActiveComponents=function(){Object.values(GLOBALS.ACTIVE_COMPONENTS).forEach(function(e){typeof e.onMount==='function'&&e.onMount(e)})};function action(e,t,n){var r=n.value;n.value=function(){var e=[],t=arguments.length;while(t--)e[t]=arguments[t];this.setState.call(this,r.call.apply(r,[this].concat(e)))};return n}var Radi={version:GLOBALS.VERSION,activeComponents:GLOBALS.ACTIVE_COMPONENTS,r:r,listen:listen,l:listen,component:Component,Component:Component,action:action,headless:function(e,t){var n=new t;n.mount();return GLOBALS.HEADLESS_COMPONENTS['$'.concat(e)]=n},mount:mount,freeze:function(){GLOBALS.FROZEN_STATE=!0},unfreeze:function(){GLOBALS.FROZEN_STATE=!1;remountActiveComponents()}};Radi.plugin=function(e){var t=[],n=arguments.length-1;while(n-->0)t[n]=arguments[n+1];return e.apply(void 0,[Radi].concat(t))};window&&(window.Radi=Radi);export default Radi