var GLOBALS={VERSION:'0.5.0',CUSTOM_ATTRIBUTES:{},CUSTOM_TAGS:{},SERVICES:{}};function capitalise(n){return n.charAt(0).toUpperCase()+n.substr(1)}function ensureArray(n){if(arguments.length===0){return[]}if(arguments.length===1){if(n===void 0||n===null){return[]}if(Array.isArray(n)){return n}}return Array.prototype.slice.call(arguments)}function flatten(n){return n.reduce(function(n,t){return n.concat(Array.isArray(t)?flatten(t):t)},[])}var Component=function(n,t){this.self=n;this.name=t||n.name;this.__$events={}};Component.prototype.on=function(n,t){var e=this.__$events,r="on"+(capitalise(n));e[r]||(e[r]=[]);e[r].push(t);return t};Component.prototype.trigger=function(n){var t,e,r=[],o=arguments.length-1;while(o-->0)r[o]=arguments[o+1];var i="on"+(capitalise(n));(this.__$events[i]||[]).map(function(n){return n.apply(void 0,r)});typeof this[i]==='function'&&(t=this)[i].apply(t,r);typeof this.self[i]==='function'&&(e=this.self)[i].apply(e,r)};function service(n,t){var e=[],r=arguments.length-2;while(r-->0)e[r]=arguments[r+2];if(typeof n!=='string'){throw new Error('[Radi.js] Service first argument has to be string')}if(typeof t!=='function'){throw new Error('[Radi.js] Service second argument has to be function')}var o='$'.concat(n),i=t.apply(void 0,e);Component.prototype[o]=i;return GLOBALS.SERVICES[o]=i}function destroyTree$$1(n){fireEvent('destroy',n);if(n.nodeType===1){var t=n.firstChild;while(t)destroyTree$$1(t),t=t.nextSibling}}function fireEvent(n,t){var e=document.createEvent('Event');e.initEvent(n,!0,!0);typeof t.dispatchEvent==='function'&&(t._eventFired=!0,t.dispatchEvent(e));return t}function insertAfter(n,t,e){e||(e=t.parentNode);if(n instanceof Node){if(t===null||t===void 0){return e.insertBefore(n,t)}if(t instanceof Node){return e.insertBefore(n,t.nextSibling)}}return n}function nodeChanged(n,t){if(n===void 0||t===void 0){return!1}if(typeof n!==typeof t){return!0}if((typeof n==='string'||typeof n==='number')&&n!==t){return!0}if(n.type!==t.type){return!0}if(n.props){return!0}return!1}function autoUpdate(n,t){if(typeof n==='function'&&n.__radiStateUpdater){return n(t)}return t(n)}function setBooleanProp(n,t,e){e?(n.setAttribute(t,e),n[t]=!0):(n[t]=!1)}function removeBooleanProp(n,t){n.removeAttribute(t);n[t]=!1}function isEventProp(n){return /^on/.test(n)}function extractEventName(n){return n.slice(2).toLowerCase()}function isCustomProp(n){return isEventProp(n)}function setProp(n,t,e){t==='style'?setStyles(n,e):isCustomProp(t)||(t==='className'?n.setAttribute('class',e):typeof e==='boolean'?setBooleanProp(n,t,e):n.setAttribute(t,e))}function removeProp(n,t,e){isCustomProp(t)||(t==='className'?n.removeAttribute('class'):typeof e==='boolean'?removeBooleanProp(n,t):n.removeAttribute(t))}function setStyles(n,t){Object.keys(t).forEach(function(e){autoUpdate(t[e],function(t){n.style[e]=t})})}function setProps(n,t){Object.keys(t).forEach(function(e){autoUpdate(t[e],function(t){(e==='class'||e==='className')&&(Array.isArray(t)&&(t=t.filter(function(n){return n&&typeof n!=='function'}).join(' ')));setProp(n,e,t)})})}function updateProp(n,t,e,r){e?(!r||e!==r)&&setProp(n,t,e):removeProp(n,t,r)}function updateProps(n,t,e){e===void 0&&(e={});var r=Object.assign({},t,e);Object.keys(r).forEach(function(r){autoUpdate(t[r],function(t){updateProp(n,r,t,e[r])})})}function addEventListeners(n,t){var e=['mount','destroy'];Object.keys(t).forEach(function(r){isEventProp(r)&&n.addEventListener(extractEventName(r),function(o){e.indexOf(r)>=0?(n===o.target&&t[r](o)):t[r](o)},!1)})}function patch(n,t,e,r,o){r===void 0&&(r=0);var i=n&&n.childNodes[r];o&&(r=Array.prototype.indexOf.call(n.childNodes,o)+1);var u=flatten(ensureArray(t)),c=flatten(ensureArray(e)),l=u.length,a=c.length,d=0;for(var f=0;f<l||f<a;f++){u[f] instanceof Date&&(u[f]=u[f].toString());if(c[f]===!1||c[f]===void 0||c[f]===null)i=createElement$$1(u[f],n),o?insertAfter(i,n.childNodes[(r+f-1)],n):n.appendChild(i),fireEvent('mount',i);else if(u[f]===!1||u[f]===void 0||u[f]===null){var s=n.childNodes[r+f+d];s&&(n.removeChild(s),destroyTree$$1(s),d-=1)}else if(nodeChanged(u[f],c[f]))n.replaceChild(i=createElement$$1(u[f],n),n.childNodes[r+f]),fireEvent('mount',i);else if(typeof u[f].type==='string'){var p=u[f],h=c[f];updateProps(n.childNodes[r+f],p.props,h.props);var g=p.children.length,y=h.children.length;for(var m=0;m<g||m<y;m++)patch(n.childNodes[r+f],p.children[m],h.children[m],m)}}return u}function mount(n,t){return{component:n,node:patch(t,n),destroy:function(){return patch(t,null,n)}}}function createElement$$1(n,t){if(typeof n==='string'||typeof n==='number'){return document.createTextNode(n)}if(n===void 0||n===!1||n===null){return document.createComment('')}if(Array.isArray(n)){var e=document.createTextNode('');e.addEventListener('mount',function(){for(var e=0;e<n.length;e++)mount(n[e],t)});return e}if(typeof n==='function'||typeof n.type==='function'){var r=n.type||n,o=new Component(r),i=createElement$$1(r.call(o,Object.assign({},(n.props||{}),{children:n.children||[]})),t),u;i&&typeof i.addEventListener==='function'&&(i.addEventListener('mount',function(){typeof o.style==='string'&&(u=document.createElement('style'),u.innerHTML=o.style,document.head.appendChild(u));o.trigger('mount',i,t)},{passive:!0,once:!0},!1),i.addEventListener('destroy',function(){o.trigger('destroy',i,t);u instanceof Node&&document.head.removeChild(u)},{passive:!0,once:!0},!1));return i}if(typeof n==='object'){if(n.type){var c;n.type==='svg'||t instanceof SVGElement?(c=document.createElementNS('http://www.w3.org/2000/svg',n.type)):(c=document.createElement(n.type));var l=null;setProps(c,n.props);addEventListeners(c,n.props);var a=function(n){return function(t){var e=createElement$$1(t,n);e&&(l?insertAfter(e,l,n):(n.appendChild.call(c,e),fireEvent('mount',e)))}};n.children.map(a(c));return c}return createElement$$1(JSON.stringify(n),t)}console.error('Unhandled node',n);return null}function customAttribute(n,t,e){e===void 0&&(e={});var r=e.allowedTags,o=e.addToElement;return GLOBALS.CUSTOM_ATTRIBUTES[n]={name:n,caller:t,allowedTags:r||null,addToElement:o}}function customTag(n,t){return GLOBALS.CUSTOM_TAGS[n]={name:n,render:t||(function(){})}}function html(n,t){var e=[],r=arguments.length-2;while(r-->0)e[r]=arguments[r+2];var o=n;typeof GLOBALS.CUSTOM_TAGS[n]!=='undefined'&&(o=GLOBALS.CUSTOM_TAGS[n].render);return{type:typeof o==='number'?o+'':o,props:t||{},children:flatten(e)}}function setDataInObject(n,t,e){var r=t[0],o={};o[r]=n[r];var i=o,u=0;while(u<t.length-1)i=i[t[u++]];i[t[u]]=e;return o}function mapData(n,t,e,r){r===void 0&&(r=[]);var o={};n&&n.$loading&&Object.defineProperty(o,'$loading',{value:!0,writable:!1});e||(e=o);var i=function(i){var u=i;if(typeof n[i]==='function'){var c=n[i](function(n,o){var i=setDataInObject(e,r.concat(u),n);o?t.update(i):t.dispatch(function(){return i})});o[u]=typeof c==='object'?c:{};Object.defineProperty(o[u],'$loading',{value:!0,writable:!1})}else o[u]=n[u]&&typeof n[u]==='object'&&!Array.isArray(n[u])?mapData(n[u],t,e,r.concat(u)):n[u]};for(var u in n)i(u);return o}function Store(n){n===void 0&&(n={});var t={},e=[],r=[],o;Object.setPrototypeOf(t,{getInitial:function(){return i},get:function(){return o},update:function(n,i){var u=Object.assign({},o,mapData(n,t));o=u;i||r.map(function(n){typeof n==='function'&&n(u);return!1});e.map(function(n){typeof n==='function'&&n(u);return!1});return o},subscribe:function(n,t){t?r.push(n):e.push(n)},dispatch:function(n){var t=[],e=arguments.length-1;while(e-->0)t[e]=arguments[e+1];var r=n.apply(void 0,[o].concat(t));return this.update(r)},render:function(n){n===void 0&&(n=function(n){return JSON.stringify(n)});var t,r,i,u,c=!1;function l(e){i=n(e);patch(t,i,u,0,r);u=i;return e}e.push(function(n){c&&l(n);return n});function a(){this.onMount=function(n,e){c=!0;r=n;t=e||n.parentNode;l(o)};return''}return a},inject:function(n){if(typeof n!=='function'){console.warn('[Radi.js] Store\'s `.inject()` method must not be called on it\'s own. Instead use `{ field: Store.inject }`.');return}t.subscribe(n,!0);n(o,!0);return o},out:function(n){var e;function r(r){if(typeof r==='function')t.subscribe(function(t){var o=n(t);e!==o&&r(o)}),r(e=n(o),!0);else{var i=t.render(n);return i}return e}r.__radiStateUpdater=!0;return r}});var i=mapData(n,t);o=i;return t}function Subscribe(n){n===void 0&&(n=document);return{on:function(t,e){e===void 0&&(e=function(n){return n});var r=null,o=null,i=null,u=!1,c=typeof e==='object'?function(n){return(Object.keys(e).reduce(function(t,e){var r;return(Object.assign({},t,(r={}, r[e]=n[e], r)))},{}))}:e;if(typeof c!=='function'){throw new Error('[Radi.js] Subscription `'+t+'` must be transformed by function');return}function l(e){return function(l){u=!0;o=e;i=l;n.addEventListener(t,r=function(){var n=[],t=arguments.length;while(t--)n[t]=arguments[t];return l(c.apply(void 0,n))});return e}}l.stop=function(){return u&&(n.removeEventListener(t,r), u=!u)};l.start=function(){return!u&&l(o)(i)};return l}}}var h=html,ModalStore=new Store({}),registerModal=function(n,t){var e;return(e={}, e[t]=!1, e)},switchModal=function(n,t,e){var r;return(r={}, r[t]=e, r)},ModalService=service('modal',function(){var n=[],t=arguments.length;while(t--)n[t]=arguments[t];return{open:function(n){return ModalStore.dispatch(switchModal,n,!0)},close:function(n){return ModalStore.dispatch(switchModal,n,!1)}}}),Modal=customTag('modal',function(n){var t=this,e=n.name;e===void 0&&(e='default');var r=n.children;typeof e==='undefined'&&console.warn('[Radi.js] Warn: Every <modal> tag needs to have `name` attribute!');this.style="\n      .--radi-modal {\n        display: block;\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        z-index: 1000;\n      }\n      .--radi-modal-backdrop {\n        display: block;\n        position: absolute;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        z-index: 0;\n        background-color: rgba(0, 0, 0, 0.7);\n      }\n      .--radi-modal-content {\n        display: block;\n        position: relative;\n        width: 600px;\n        max-width: 98%;\n        z-index: 1;\n        margin: 40px auto;\n        border-radius: 8px;\n        box-shadow: 0 5px 0px rgba(0, 0, 0, 0.1), 0 20px 50px rgba(0, 0, 0, 0.3);\n        background-color: #fff;\n        padding: 26px;\n      }\n    ";this.onMount=function(n){return ModalStore.dispatch(registerModal,e)};return h('portal',{},ModalStore.out(function(n){return n[e]&&h('div',{class:'--radi-modal',name:e},h('div',{class:'--radi-modal-backdrop',onclick:function(){return t.$modal.close(e)}}),h.apply(void 0,['div',{class:'--radi-modal-content'}].concat((r.slice()))))}))}),Portal=customTag('portal',function(n){var t,e,r=n.children||[];this.onMount=function(o){mount(function(){this.onMount=function(n,r){t=n;e=r};return function(){return r}},n.on||document.body)};this.onDestroy=function(n,o){patch(e,null,r,0,t||n)};return null}),Radi={v:GLOBALS.VERSION,version:GLOBALS.VERSION,h:html,html:html,Store:Store,customTag:customTag,customAttribute:customAttribute,patch:patch,mount:mount,service:service,Subscribe:Subscribe};Radi.plugin=function(n){var t=[],e=arguments.length-1;while(e-->0)t[e]=arguments[e+1];return n.apply(void 0,[Radi].concat(t))};window&&(window.Radi=Radi);export default Radi