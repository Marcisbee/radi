{"version":3,"sources":["LargeRepl.radi","Repl.radi"],"names":["action","subscribe","worker","_radi_listen","listen","LargeRepl","args","state","scroll","error","code","height","url","on","mount","window","onresize","trigger","e","target","fn","editor","ace","edit","mode","selectionStyle","cursorStyle","showPrintMargin","tabSize","fixedWidthGutter","foldStyle","useWorker","tooltipFollowsMouse","$router","params","fromBase64","replace","originalChange","getValue","loadJS","destroy","lastmount","i","length","resize","el","parseInt","innerHeight","sStartTag","sEndTag","cb","bDouble","arguments","nSelStart","selectionStart","nSelEnd","selectionEnd","sOldText","value","substring","setSelectionRange","focus","keyCode","which","preventDefault","insertMetachars","dispatchEvent","Event","scrollTop","console","message","codeChange","self","transformed","Babel","transform","presets","plugins","legacy","del","document","getElementById","$id","parentNode","replaceChild","cloneNode","eval","setError","name","based","toBase64","history","replaceState","title","location","href","parsed","build","string","encodeURIComponent","btoa","unescape","decodeURIComponent","escape","atob","component","Component","Repl","startingCode"],"mappings":"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","file":"7fc0d4a50ff645b1a1d2ac433087a5da.map","sourcesContent":["/** @jsx _radi.r **/\n  /** @radi-listen _radi_listen **/\n\n  import _radi from 'radi';\n  const action = _radi.action;\n  const subscribe = _radi.subscribe;\n  const worker = _radi.worker;\n  const _radi_listen = _radi.listen;\n\n  import radiListen from 'babel-plugin-transform-radi-listen'\nimport parse from '../helpers/radi-compiler-browser.js'\nimport '../../assets/stylus/large-repl.styl'\n\n  export default class LargeRepl extends _radi.Component {\n    constructor(...args) {\n      super(...args);\n      this.state = {\n  scroll: 0,\n  error: null,\n  code: '',\n  height: 800,\n  url: '',\n};\n      this.on = {\n  mount() {\n    window.onresize = e => this.trigger('resize', e.target);\n    this.trigger('resize', window);\n\n    let fn = () => {\n      // ace.define(`function(require, exports, module) {\n      //   var JsxHighlightRules = require(\"ace/mode/jsx_highlight_rules\").JsxHighlightRules;\n      //\n      // \t(function() {\n      //\n      //     this.$rules = new JsxHighlightRules().getRules();\n      //\n      //     var newRules = {\n      //       start: [\n      //         {\n      //           token : \"pipeline.operator\",\n      //           regex : \"\\|\\>\"\n      //         }\n      //       ]\n      //     };\n      //     this.addRules(newRules, \"new-\");\n      //\n      //   }).call(JsxHighlightRules.prototype);\n      //\n      //   exports.JsxHighlightRules = JsxHighlightRules;\n      // }`, 1);\n      let editor = ace.edit(\"aceditor\", {\n        mode: \"ace/mode/javascript\",\n        selectionStyle: \"text\",\n        cursorStyle: \"smooth\",\n        showPrintMargin: false,\n        tabSize: 2,\n        fixedWidthGutter: true,\n        foldStyle: \"manual\",\n        useWorker: false,\n        tooltipFollowsMouse: false,\n        selectionStyle: \"line\",\n        scrollPastEnd: true,\n        fontSize: 14,\n        value: this.$router.state.params.code\n          ? this.fromBase64(this.$router.state.params.code.replace(/^code\\=/, ''))\n          : this.state.code,\n      });\n\n      this.originalChange(editor.getValue());\n      editor.on(\"change\", (e) => {\n        this.originalChange(editor.getValue());\n      });\n    }\n    loadJS('https://unpkg.com/@babel/standalone@7.0.0-beta.46/babel.min.js', () => {\n      loadJS('https://ajaxorg.github.io/ace-builds/src-min-noconflict/ace.js', fn);\n    });\n  },\n  destroy() {\n    if (window.lastmount) {\n      for (var i = 0; i < window.lastmount.length; i++) {\n        window.lastmount[i].destroy();\n      }\n    }\n  },\n  @action resize(el) {\n    return {\n      height: parseInt(el.innerHeight, 10),\n    }\n  },\n};\n    }\n\n    \ninsertMetachars(el, sStartTag, sEndTag, cb) {\n  let bDouble = arguments.length > 1, nSelStart = el.selectionStart, nSelEnd = el.selectionEnd, sOldText = el.value;\n  el.value = sOldText.substring(0, nSelStart) + (bDouble ? sStartTag + sOldText.substring(nSelStart, nSelEnd) + sEndTag : sStartTag) + sOldText.substring(nSelEnd);\n  el.setSelectionRange(bDouble || nSelStart === nSelEnd ? nSelStart + sStartTag.length : nSelStart, (bDouble ? nSelEnd : nSelStart) + sStartTag.length);\n  el.focus();\n  cb();\n}\n\n\nreplInput(e) {\n  var code = e.keyCode || e.which;\n  if (code == '9') {\n    e.preventDefault();\n    this.insertMetachars(e.target, '   ','', () => {\n      e.target.dispatchEvent(new window.Event('input', {\n        'bubbles': true,\n        'cancelable': true\n      }));\n    });\n  }\n}\n\n@action scrollCode(e) {\n  return {\n    scroll: e.target.scrollTop,\n  }\n}\n\n@action setError(value, e) {\n  if (value) {\n    value[1] = value[1].replace(/^unknown\\: /, '')\n    console.error(e.message);\n  }\n  return {\n    error: value || null,\n  }\n}\n\n@action originalChange(code) {\n  this.codeChange(code, 'Sample');\n  return {\n    code,\n  };\n}\n\n\nbuild(code) {\n  var self = this;\n  var transformed = Babel.transform(code, {\n    presets: [],\n    plugins: [\n      ['proposal-pipeline-operator'],\n      ['proposal-decorators', {\n        legacy: true,\n      }],\n      'transform-classes',\n      [radiListen],\n      'transform-react-jsx',\n    ]\n  });\n\n  (function (code) {\n    if (window.lastmount) {\n      for (var i = 0; i < window.lastmount.length; i++) {\n        window.lastmount[i].destroy();\n      }\n    }\n    var del = document.getElementById('repl-out-' + self.$id);\n    del.parentNode.replaceChild(del.cloneNode(false), del);\n    eval(code + 'window.lastmount = Radi.mount([new Sample()], \"repl-out-' + self.$id+ '\");');\n    self.setError();\n  })(transformed.code);\n}\n\n\ncodeChange(value, name) {\n  let based = this.toBase64(value).url;\n  window.history.replaceState({} , document.title, window.location.href.replace(/\\/code\\=.*/, '') + '/code=' + based);\n  try {\n    var parsed = parse(name, value);\n    this.build(parsed);\n  } catch (e) {\n    this.setError([e.name, e.message], e);\n  }\n}\n\n@action toBase64(string) {\n  return {\n    url: window.encodeURIComponent(window.btoa(window.unescape(window.encodeURIComponent(string)))),\n  }\n}\n\n\nfromBase64(string) {\n  return window.decodeURIComponent(window.escape(window.atob(window.decodeURIComponent(string))))\n}\n\n    view() {\n        const component = this;\n        return [\n<template>\n  <div class={ [ 'large-repl-wrap', 'repl-wrap', component.state.error && 'repl-error' ] } style={ { height: (component.state.height - 54) + 'px' } }>\n    <div class=\"repl-head\">\n      <strong>Radi live editor</strong>\n      <div>\n        <span>{ component.state.error ? 'Error' : 'Live preview' }</span>\n      </div>\n    </div>\n    <div class=\"repl-container\">\n      <pre id=\"aceditor\" style={ { height: (component.state.height - 95) + 'px' } }></pre>\n      {/* <div class=\"backdrop\">\n        <pre style={ {marginTop: (-this.state.scroll) + 'px'} }><code class=\"tlit-highlight\">{ new DOMParser().parseFromString('<div>' + Prism.highlight(this.state.code, Prism.languages.jsx) + '</div>', \"text/html\").body.children[0] }</code></pre>\n      </div>\n      <textarea class=\"tlit-text\"\n        onkeydown={ (e) => this.replInput(e) }\n        onscroll={ (e) => this.scrollCode(e) }\n        class=\"tlit-text\"\n        autocomplete=\"off\"\n        autocorrect=\"off\"\n        autocapitalize=\"off\"\n        spellcheck=\"false\"\n        style={ { height: (this.state.height - 95) + 'px' } }\n        // model={ this.state.code }\n        oninput={ (e) => this.originalChange(e.target.value) }>{ this.state.code }</textarea> */}\n    </div>\n    { component.state.error &&\n      <pre class=\"repl-out-error\" style={ { height: (component.state.height - 95) + 'px' } }>\n        <strong>{ component.state.error[0] }</strong>\n        <p>{ component.state.error[1] }</p>\n      </pre>\n    }\n    <div id={ 'repl-out-' + this.$id } class=\"repl-output\" style={ { height: (component.state.height - 95) + 'px' } }>\n      <i style=\"color: #ccc\">Loading Babel...</i>\n    </div>\n  </div>\n</template>];\n      }\n\n  };","/** @jsx _radi.r **/\n  /** @radi-listen _radi_listen **/\n\n  import _radi from 'radi';\n  const action = _radi.action;\n  const subscribe = _radi.subscribe;\n  const worker = _radi.worker;\n  const _radi_listen = _radi.listen;\n\n  import globals from '../helpers/globals';\nimport LargeRepl from '../components/LargeRepl.radi'\nimport Header from '../components/Header.radi'\nimport '../../assets/stylus/large-repl.styl'\n\n  export default class Repl extends _radi.Component {\n    constructor(...args) {\n      super(...args);\n      this.state = {};\n      this.on = {};\n    }\n\n    \n\n    view() {\n        const component = this;\n        return [\n<template>\n  <div>\n    <Header location=\"at-repl\" />\n    <LargeRepl code={ globals.startingCode } />\n  </div>\n</template>];\n      }\n\n  };"]}